<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Life Manager - Comrade Ibn Imam</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            min-height: 100vh;
        }
        
        .elegant-font {
            font-family: 'Playfair Display', serif;
        }
        
        .comrade-gradient {
            background: linear-gradient(135deg, #7c3aed 0%, #4f46e5 100%);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .task-item {
            transition: all 0.3s ease;
            border-left: 4px solid;
        }
        
        .task-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .priority-important { border-left-color: #dc2626; background: linear-gradient(90deg, #fef2f2 0%, #ffffff 100%); }
        .priority-high { border-left-color: #ea580c; background: linear-gradient(90deg, #fff7ed 0%, #ffffff 100%); }
        .priority-medium { border-left-color: #16a34a; background: linear-gradient(90deg, #f0fdf4 0%, #ffffff 100%); }
        .priority-low { border-left-color: #2563eb; background: linear-gradient(90deg, #eff6ff 0%, #ffffff 100%); }
        
        .status-pending { 
            background: #fef3c7; 
            color: #d97706;
            border: 1px solid #fbbf24;
        }
        .status-in-progress { 
            background: #dbeafe; 
            color: #1d4ed8;
            border: 1px solid #60a5fa;
        }
        .status-completed { 
            background: #d1fae5; 
            color: #065f46;
            border: 1px solid #34d399;
        }
        
        .category-personal { background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); }
        .category-work { background: linear-gradient(135deg, #10b981 0%, #047857 100%); }
        .category-social { background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); }
        .category-health { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .category-errands { background: linear-gradient(135deg, #ec4899 0%, #db2777 100%); }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pulse-gentle {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        .scrollbar-thin::-webkit-scrollbar {
            width: 4px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
        
        .hidden {
            display: none;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background-color: #10b981;
        }
        
        .notification.error {
            background-color: #ef4444;
        }
        
        .notification.info {
            background-color: #3b82f6;
        }
        
        .login-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    
    <!-- Setup Screen (Shows on first use) -->
    <div id="setupScreen" class="login-container max-w-md w-full rounded-3xl shadow-2xl p-8 hidden">
        <div class="text-center mb-8">
            <div class="comrade-gradient w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-user-shield text-3xl text-white"></i>
            </div>
            <h2 class="elegant-font text-3xl font-bold text-gray-800 mb-2">Welcome, Comrade</h2>
            <p class="text-gray-600">Set up your secure access</p>
        </div>
        
        <form id="setupForm" class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Your Name</label>
                <input type="text" id="userName" class="w-full p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500" 
                       placeholder="Enter your name" required>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Create Password</label>
                <input type="password" id="newPassword" class="w-full p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500" 
                       placeholder="Create a secure password" required minlength="4">
                <p class="text-xs text-gray-500 mt-1">Minimum 4 characters</p>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Confirm Password</label>
                <input type="password" id="confirmPassword" class="w-full p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500" 
                       placeholder="Confirm your password" required>
            </div>
            
            <button type="submit" class="w-full comrade-gradient text-white py-4 rounded-xl hover:shadow-lg transition-all font-semibold text-lg">
                <i class="fas fa-save mr-2"></i>Save & Continue
            </button>
        </form>
        
        <div id="setupError" class="mt-4 p-3 bg-red-100 border border-red-300 text-red-700 rounded-lg hidden">
            <i class="fas fa-exclamation-circle mr-2"></i>
            <span id="setupErrorMessage">Passwords do not match</span>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="loginScreen" class="login-container max-w-md w-full rounded-3xl shadow-2xl p-8">
        <div class="text-center mb-8">
            <div class="comrade-gradient w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-user-tie text-3xl text-white"></i>
            </div>
            <h2 class="elegant-font text-3xl font-bold text-gray-800 mb-2" id="loginTitle">Daily Life Manager</h2>
            <p class="text-gray-600" id="loginSubtitle">For Comrade Ibn Imam</p>
        </div>
        
        <form id="loginForm" class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                <input type="password" id="password" class="w-full p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500" 
                       placeholder="Enter your password" required>
            </div>
            
            <button type="submit" class="w-full comrade-gradient text-white py-4 rounded-xl hover:shadow-lg transition-all font-semibold text-lg">
                <i class="fas fa-lock mr-2"></i>Access Manager
            </button>
        </form>
        
        <div class="mt-4 text-center">
            <button id="resetPasswordBtn" class="text-purple-600 hover:text-purple-800 text-sm">
                <i class="fas fa-key mr-1"></i>Reset Password
            </button>
        </div>
        
        <div id="loginError" class="mt-4 p-3 bg-red-100 border border-red-300 text-red-700 rounded-lg hidden">
            <i class="fas fa-exclamation-circle mr-2"></i>
            <span id="errorMessage">Invalid password</span>
        </div>
    </div>

    <!-- Reset Password Screen -->
    <div id="resetScreen" class="login-container max-w-md w-full rounded-3xl shadow-2xl p-8 hidden">
        <div class="text-center mb-8">
            <div class="comrade-gradient w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-key text-3xl text-white"></i>
            </div>
            <h2 class="elegant-font text-2xl font-bold text-gray-800 mb-2">Reset Password</h2>
            <p class="text-gray-600">You'll need to set up again</p>
        </div>
        
        <div class="text-center">
            <p class="text-gray-700 mb-6">Resetting will clear all your current tasks and settings.</p>
            <button id="confirmResetBtn" class="w-full bg-red-600 text-white py-4 rounded-xl hover:bg-red-700 transition-all font-semibold text-lg">
                <i class="fas fa-exclamation-triangle mr-2"></i>Reset Everything
            </button>
            <button id="cancelResetBtn" class="w-full mt-3 bg-gray-600 text-white py-3 rounded-xl hover:bg-gray-700 transition-all font-medium">
                Cancel
            </button>
        </div>
    </div>

    <!-- Main Application (Hidden by default) -->
    <div id="mainApp" class="hidden max-w-6xl w-full glass-effect rounded-3xl shadow-2xl overflow-hidden">
        <!-- Header -->
        <div class="comrade-gradient text-white p-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="elegant-font text-4xl font-bold mb-2">Daily Life Manager</h1>
                    <p class="text-purple-100 text-lg" id="userGreeting">For Comrade Ibn Imam</p>
                    <p class="text-purple-200 text-sm mt-1">Elegant. Organized.</p>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="bg-white/20 p-4 rounded-2xl text-center">
                        <i class="fas fa-user-tie text-3xl mb-2"></i>
                        <p class="text-sm font-medium" id="userDisplayName">Comrade Imam</p>
                    </div>
                </div>
            </div>
            
            <!-- Quick Stats -->
            <div class="grid grid-cols-4 gap-6 mt-8">
                <div class="bg-white/20 rounded-xl p-4 text-center pulse-gentle">
                    <div class="text-2xl font-bold" id="totalTasks">0</div>
                    <div class="text-sm text-purple-100">Total Tasks</div>
                </div>
                <div class="bg-white/20 rounded-xl p-4 text-center">
                    <div class="text-2xl font-bold" id="importantTasks">0</div>
                    <div class="text-sm text-purple-100">Important</div>
                </div>
                <div class="bg-white/20 rounded-xl p-4 text-center">
                    <div class="text-2xl font-bold" id="todayTasks">0</div>
                    <div class="text-sm text-purple-100">Today</div>
                </div>
                <div class="bg-white/20 rounded-xl p-4 text-center">
                    <div class="text-2xl font-bold" id="completedTasks">0</div>
                    <div class="text-sm text-purple-100">Completed</div>
                </div>
            </div>
        </div>
        
        <!-- Task Input Section -->
        <div class="p-8 bg-gray-50/50">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div>
                    <input type="text" id="taskInput" placeholder="What needs your attention today, Comrade?" 
                           class="w-full p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 text-lg elegant-font">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <select id="taskCategory" class="p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500">
                        <option value="personal">Personal</option>
                        <option value="work">Work</option>
                        <option value="social">Social</option>
                        <option value="health">Health & Fitness</option>
                        <option value="errands">Errands</option>
                    </select>
                    
                    <select id="prioritySelect" class="p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500">
                        <option value="low">Low Priority</option>
                        <option value="medium">Medium Priority</option>
                        <option value="high">High Priority</option>
                        <option value="important">Important</option>
                    </select>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                <input type="text" id="location" placeholder="Location (Optional)" 
                       class="p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500">
                
                <input type="text" id="withWho" placeholder="With Whom (Optional)" 
                       class="p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500">
                
                <input type="datetime-local" id="dueDate" 
                       class="p-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500">
            </div>
            
            <div class="flex justify-between items-center">
                <button id="addTaskBtn" class="px-8 py-4 comrade-gradient text-white rounded-xl hover:shadow-lg transition-all font-semibold text-lg">
                    <i class="fas fa-plus-circle mr-2"></i>Add Task
                </button>
                
                <div class="flex space-x-3">
                    <button id="exportBtn" class="px-6 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors">
                        <i class="fas fa-file-export mr-2"></i>Export
                    </button>
                    <button id="clearCompleted" class="px-6 py-3 bg-gray-600 text-white rounded-xl hover:bg-gray-700 transition-colors">
                        Clear Completed
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Filters and Tasks Section -->
        <div class="p-8">
            <div class="flex justify-between items-center mb-8">
                <h2 class="elegant-font text-2xl font-semibold text-gray-800">Daily Activities Dashboard</h2>
                <div class="flex space-x-3">
                    <button id="filterAll" class="filter-btn active bg-purple-100 text-purple-600 px-4 py-2 rounded-xl font-medium">
                        All Tasks
                    </button>
                    <button id="filterToday" class="filter-btn bg-gray-100 text-gray-600 px-4 py-2 rounded-xl font-medium">
                        Today
                    </button>
                    <button id="filterCompleted" class="filter-btn bg-gray-100 text-gray-600 px-4 py-2 rounded-xl font-medium">
                        Completed
                    </button>
                </div>
            </div>
            
            <!-- Category Filters -->
            <div class="mb-6 flex space-x-3 overflow-x-auto pb-4">
                <button class="category-filter active bg-white border-2 border-purple-500 text-purple-600 px-4 py-2 rounded-full font-medium">
                    All Categories
                </button>
                <button class="category-filter bg-white border border-gray-300 text-gray-600 px-4 py-2 rounded-full font-medium category-personal text-white">
                    Personal
                </button>
                <button class="category-filter bg-white border border-gray-300 text-gray-600 px-4 py-2 rounded-full font-medium category-work text-white">
                    Work
                </button>
                <button class="category-filter bg-white border border-gray-300 text-gray-600 px-4 py-2 rounded-full font-medium category-social text-white">
                    Social
                </button>
                <button class="category-filter bg-white border border-gray-300 text-gray-600 px-4 py-2 rounded-full font-medium category-health text-white">
                    Health
                </button>
            </div>
            
            <!-- Tasks List -->
            <div id="taskList" class="space-y-4 max-h-96 overflow-y-auto scrollbar-thin pr-4">
                <div id="emptyState" class="text-center text-gray-500 py-12">
                    <i class="fas fa-clipboard-list text-6xl mb-4 opacity-50"></i>
                    <p class="elegant-font text-xl mb-2">No tasks scheduled yet, Comrade</p>
                    <p class="text-gray-600">Add your first task to begin organizing your elegant lifestyle</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced authentication system with user-set passwords
        class AuthManager {
            constructor() {
                this.userConfig = JSON.parse(localStorage.getItem('dailyLifeConfig')) || null;
                this.setupScreen = document.getElementById('setupScreen');
                this.loginScreen = document.getElementById('loginScreen');
                this.resetScreen = document.getElementById('resetScreen');
                this.mainApp = document.getElementById('mainApp');
                
                this.setupForm = document.getElementById('setupForm');
                this.loginForm = document.getElementById('loginForm');
                
                this.init();
            }
            
            init() {
                // Check if user needs to set up first
                if (!this.userConfig) {
                    this.showSetup();
                    return;
                }
                
                // Check if already logged in
                if (this.isAuthenticated()) {
                    this.showApp();
                    return;
                }
                
                this.showLogin();
                this.updateLoginUI();
            }
            
            showSetup() {
                this.hideAllScreens();
                this.setupScreen.classList.remove('hidden');
                
                this.setupForm.addEventListener('submit', (e) => this.handleSetup(e));
            }
            
            showLogin() {
                this.hideAllScreens();
                this.loginScreen.classList.remove('hidden');
                
                this.loginForm.addEventListener('submit', (e) => this.handleLogin(e));
                document.getElementById('resetPasswordBtn').addEventListener('click', () => this.showReset());
            }
            
            showReset() {
                this.hideAllScreens();
                this.resetScreen.classList.remove('hidden');
                
                document.getElementById('confirmResetBtn').addEventListener('click', () => this.handleReset());
                document.getElementById('cancelResetBtn').addEventListener('click', () => this.showLogin());
            }
            
            handleSetup(e) {
                e.preventDefault();
                
                const userName = document.getElementById('userName').value.trim();
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                if (newPassword !== confirmPassword) {
                    this.showSetupError('Passwords do not match');
                    return;
                }
                
                if (newPassword.length < 4) {
                    this.showSetupError('Password must be at least 4 characters');
                    return;
                }
                
                // Save user configuration
                this.userConfig = {
                    userName: userName,
                    password: newPassword,
                    setupDate: new Date().toISOString()
                };
                
                localStorage.setItem('dailyLifeConfig', JSON.stringify(this.userConfig));
                
                // Auto-login after setup
                this.loginAfterSetup(newPassword);
            }
            
            loginAfterSetup(password) {
                const loginData = {
                    loggedIn: true,
                    timestamp: Date.now(),
                    expiresIn: 24 * 60 * 60 * 1000
                };
                localStorage.setItem('dailyLifeAuth', JSON.stringify(loginData));
                
                this.showApp();
            }
            
            handleLogin(e) {
                e.preventDefault();
                
                const password = document.getElementById('password').value;
                
                if (password === this.userConfig.password) {
                    const loginData = {
                        loggedIn: true,
                        timestamp: Date.now(),
                        expiresIn: 24 * 60 * 60 * 1000
                    };
                    localStorage.setItem('dailyLifeAuth', JSON.stringify(loginData));
                    
                    this.showApp();
                } else {
                    this.showLoginError('Invalid password');
                }
            }
            
            handleReset() {
                if (confirm('Are you sure? This will delete ALL your tasks and settings.')) {
                    localStorage.removeItem('dailyLifeConfig');
                    localStorage.removeItem('dailyLifeAuth');
                    localStorage.removeItem('comradeTasks');
                    window.location.reload();
                }
            }
            
            isAuthenticated() {
                const authData = localStorage.getItem('dailyLifeAuth');
                if (!authData) return false;
                
                const { loggedIn, timestamp, expiresIn } = JSON.parse(authData);
                
                if (Date.now() - timestamp > expiresIn) {
                    localStorage.removeItem('dailyLifeAuth');
                    return false;
                }
                
                return loggedIn;
            }
            
            updateLoginUI() {
                if (this.userConfig) {
                    document.getElementById('loginTitle').textContent = `Welcome back, ${this.userConfig.userName}`;
                    document.getElementById('loginSubtitle').textContent = 'Daily Life Manager';
                }
            }
            
            showApp() {
                this.hideAllScreens();
                this.mainApp.classList.remove('hidden');
            }
            
            hideAllScreens() {
                this.setupScreen.classList.add('hidden');
                this.loginScreen.classList.add('hidden');
                this.resetScreen.classList.add('hidden');
                this.mainApp.classList.add('hidden');
            }
            
            showSetupError(message) {
                const errorDiv = document.getElementById('setupError');
                errorDiv.querySelector('#setupErrorMessage').textContent = message;
                errorDiv.classList.remove('hidden');
                setTimeout(() => errorDiv.classList.add('hidden'), 3000);
            }
            
            showLoginError(message) {
                const errorDiv = document.getElementById('loginError');
                errorDiv.querySelector('#errorMessage').textContent = message;
                errorDiv.classList.remove('hidden');
                setTimeout(() => errorDiv.classList.add('hidden'), 3000);
            }
            
            logout() {
                localStorage.removeItem('dailyLifeAuth');
                window.location.reload();
            }
            
            getUserName() {
                return this.userConfig ? this.userConfig.userName : 'Comrade';
            }
        }

        // Modified DailyLifeManager
        class DailyLifeManager {
            constructor() {
                this.authManager = new AuthManager();
                if (!this.authManager.isAuthenticated()) return;
                
                this.tasks = JSON.parse(localStorage.getItem('comradeTasks')) || [];
                this.taskList = document.getElementById('taskList');
                this.emptyState = document.getElementById('emptyState');
                this.currentFilter = 'all';
                this.currentCategory = 'all';
                this.init();
            }
            
            init() {
                this.addLogoutButton();
                this.updateUserInfo();
                this.bindEvents();
                this.render();
                this.updateStats();
            }
            
            updateUserInfo() {
                const userName = this.authManager.getUserName();
                document.getElementById('userGreeting').textContent = `For ${userName}`;
                document.getElementById('userDisplayName').textContent = userName;
            }
            
            addLogoutButton() {
                const header = document.querySelector('.comrade-gradient');
                const userSection = header.querySelector('.flex.items-center.justify-between');
                
                const logoutBtn = document.createElement('button');
                logoutBtn.className = 'bg-white/20 p-2 rounded-lg hover:bg-white/30 transition-colors text-white text-sm';
                logoutBtn.innerHTML = '<i class="fas fa-sign-out-alt mr-1"></i>Logout';
                logoutBtn.addEventListener('click', () => this.authManager.logout());
                userSection.appendChild(logoutBtn);
            }
            
            bindEvents() {
                document.getElementById('addTaskBtn').addEventListener('click', () => this.addTask());
                document.getElementById('taskInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.addTask();
                });
                
                document.getElementById('filterAll').addEventListener('click', () => this.setFilter('all'));
                document.getElementById('filterToday').addEventListener('click', () => this.setFilter('today'));
                document.getElementById('filterCompleted').addEventListener('click', () => this.setFilter('completed'));
                
                document.getElementById('exportBtn').addEventListener('click', () => this.exportData());
                document.getElementById('clearCompleted').addEventListener('click', () => this.clearCompleted());
                
                document.querySelectorAll('.category-filter').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const category = e.target.textContent.trim().toLowerCase();
                        this.setCategoryFilter(category === 'all categories' ? 'all' : category);
                    });
                });
            }
            
            addTask() {
                const taskInput = document.getElementById('taskInput');
                const taskText = taskInput.value.trim();

                if (taskText) {
                    const newTask = {
                        id: Date.now(),
                        text: taskText,
                        category: document.getElementById('taskCategory').value,
                        priority: document.getElementById('prioritySelect').value,
                        location: document.getElementById('location').value.trim() || 'Not specified',
                        withWho: document.getElementById('withWho').value.trim() || 'Alone',
                        dueDate: document.getElementById('dueDate').value,
                        status: 'pending',
                        createdAt: new Date().toISOString(),
                        completedAt: null
                    };
                    
                    this.tasks.unshift(newTask);
                    this.saveTasks();
                    this.render();
                    this.updateStats();
                    
                    taskInput.value = '';
                    document.getElementById('location').value = '';
                    document.getElementById('withWho').value = '';
                    document.getElementById('dueDate').value = '';
                    
                    this.showNotification('Task added successfully!', 'success');
                } else {
                    this.showNotification('Please enter a task description!', 'error');
                }
            }
            
            removeTask(id) {
                if (confirm('Are you sure you want to delete this task?')) {
                    this.tasks = this.tasks.filter(task => task.id !== id);
                    this.saveTasks();
                    this.render();
                    this.updateStats();
                    this.showNotification('Task removed!', 'info');
                }
            }
            
            toggleStatus(id) {
                this.tasks = this.tasks.map(task => {
                    if (task.id === id) {
                        return {
                            ...task,
                            status: task.status === 'completed' ? 'pending' : 'completed',
                            completedAt: task.status === 'pending' ? new Date().toISOString() : null
                        };
                    }
                    return task;
                });
                this.saveTasks();
                this.render();
                this.updateStats();
            }
            
            setFilter(filter) {
                this.currentFilter = filter;
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('active', 'bg-purple-100', 'text-purple-600');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                document.getElementById(`filter${filter.charAt(0).toUpperCase() + filter.slice(1)}`)
                    .classList.add('active', 'bg-purple-100', 'text-purple-600');
                this.render();
            }
            
            setCategoryFilter(category) {
                this.currentCategory = category;
                document.querySelectorAll('.category-filter').forEach(btn => {
                    btn.classList.remove('active', 'border-purple-500', 'text-purple-600');
                    btn.classList.add('border-gray-300', 'text-gray-600');
                });
                document.querySelectorAll('.category-filter').forEach(btn => {
                    if ((category === 'all' && btn.textContent.trim() === 'All Categories') || 
                        btn.textContent.trim().toLowerCase() === category) {
                        btn.classList.add('active', 'border-purple-500', 'text-purple-600');
                    }
                });
                this.render();
            }
            
            getFilteredTasks() {
                let filtered = this.tasks;
                
                if (this.currentFilter === 'today') {
                    const today = new Date().toDateString();
                    filtered = filtered.filter(task => {
                        if (!task.dueDate) return false;
                        return new Date(task.dueDate).toDateString() === today;
                    });
                } else if (this.currentFilter === 'completed') {
                    filtered = filtered.filter(task => task.status === 'completed');
                }
                
                if (this.currentCategory !== 'all') {
                    filtered = filtered.filter(task => task.category === this.currentCategory);
                }
                
                return filtered;
            }
            
            render() {
                this.taskList.innerHTML = '';
                const filteredTasks = this.getFilteredTasks();
                
                if (filteredTasks.length === 0) {
                    this.emptyState.style.display = 'block';
                    this.taskList.appendChild(this.emptyState);
                    return;
                }
                
                this.emptyState.style.display = 'none';
                
                filteredTasks.forEach((task, index) => {
                    const li = document.createElement('li');
                    li.className = `task-item fade-in bg-white rounded-lg shadow-sm p-4 priority-${task.priority}`;
                    
                    li.innerHTML = `
                        <div class="flex justify-between items-start mb-2">
                            <div class="flex-1">
                                <div class="flex items-center space-x-2 mb-1">
                                    <span class="px-2 py-1 rounded-full text-xs font-medium status-${task.status}">
                                        ${task.status === 'completed' ? 'Completed' : 'Pending'}
                                    </span>
                                    <span class="px-2 py-1 bg-gray-100 rounded-full text-xs text-gray-600">
                                        ${task.category.charAt(0).toUpperCase() + task.category.slice(1)}
                                    </span>
                                </div>
                                <h3 class="font-semibold text-gray-800">${task.text}</h3>
                                <div class="text-sm text-gray-600 mt-1">
                                    <div>📍 ${task.location} | 👥 ${task.withWho}</div>
                                    ${task.dueDate ? `<div>⏰ ${new Date(task.dueDate).toLocaleString()}</div>` : ''}
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="status-btn px-3 py-1 rounded-lg text-white ${
                                    task.status === 'completed' ? 'bg-yellow-500 hover:bg-yellow-600' : 'bg-green-500 hover:bg-green-600'
                                } transition-colors">
                                    ${task.status === 'completed' ? 'Reopen' : 'Complete'}
                                </button>
                                <button class="delete-btn px-3 py-1 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <div class="text-xs text-gray-500">
                            Created: ${new Date(task.createdAt).toLocaleDateString()}
                            ${task.completedAt ? ` | Completed: ${new Date(task.completedAt).toLocaleDateString()}` : ''}
                        </div>
                    `;
                    
                    li.querySelector('.status-btn').addEventListener('click', () => this.toggleStatus(task.id));
                    li.querySelector('.delete-btn').addEventListener('click', () => this.removeTask(task.id));
                    this.taskList.appendChild(li);
                    
                    setTimeout(() => li.classList.add('fade-in'), index * 100);
                });
            }
            
            updateStats() {
                const totalTasks = this.tasks.length;
                const importantTasks = this.tasks.filter(task => task.priority === 'important').length;
                const today = new Date().toDateString();
                const todayTasks = this.tasks.filter(task => {
                    if (!task.dueDate) return false;
                    return new Date(task.dueDate).toDateString() === today;
                }).length;
                const completedTasks = this.tasks.filter(task => task.status === 'completed').length;
                
                document.getElementById('totalTasks').textContent = totalTasks;
                document.getElementById('importantTasks').textContent = importantTasks;
                document.getElementById('todayTasks').textContent = todayTasks;
                document.getElementById('completedTasks').textContent = completedTasks;
            }
            
            exportData() {
                const dataStr = JSON.stringify(this.tasks, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `daily-tasks-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                URL.revokeObjectURL(url);
                this.showNotification('Data exported successfully!', 'success');
            }
            
            clearCompleted() {
                const completedCount = this.tasks.filter(task => task.status === 'completed').length;
                if (completedCount === 0) {
                    this.showNotification('No completed tasks to clear!', 'info');
                    return;
                }
                if (confirm(`Clear ${completedCount} completed task(s)?`)) {
                    this.tasks = this.tasks.filter(task => task.status !== 'completed');
                    this.saveTasks();
                    this.render();
                    this.updateStats();
                    this.showNotification(`Cleared ${completedCount} task(s)!`, 'success');
                }
            }
            
            saveTasks() {
                localStorage.setItem('comradeTasks', JSON.stringify(this.tasks));
            }
            
            showNotification(message, type) {
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                let icon = type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle';
                notification.innerHTML = `<i class="fas ${icon} mr-2"></i> ${message}`;
                document.body.appendChild(notification);
                setTimeout(() => notification.classList.add('show'), 10);
                setTimeout(() => {
                    notification.classList.remove('show');
                    setTimeout(() => document.body.contains(notification) && document.body.removeChild(notification), 300);
                }, 3000);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            new DailyLifeManager();
        });
    </script>
</body>
</html>